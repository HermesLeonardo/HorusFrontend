<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<div class="projetos-container">
  <div class="topo-projetos">
    <h2>Gerenciamento de Projetos</h2>
    <button class="novo-projeto-btn" (click)="abrirDialog()">
      <i class="pi pi-plus"></i> Novo Projeto
    </button>
  </div>

  <!-- Seção de Filtros -->
  <div class="filtros-container">
    <p-dropdown [options]="statusOptions" [(ngModel)]="filtro.status" placeholder="Status"></p-dropdown>
    <p-dropdown [options]="prioridadeOptions" [(ngModel)]="filtro.prioridade" placeholder="Prioridade"></p-dropdown>
    <input pInputText [(ngModel)]="filtro.nome" placeholder="Buscar Projeto..." />
    <button class="filtro-btn" (click)="filtrarProjetos()">
      <i class="pi pi-filter"></i> Filtrar
    </button>
    <button class="filtro-btn limpar" (click)="resetarFiltros()">
      <i class="pi pi-times"></i> Limpar
    </button>
  </div>

  <!-- Card com Tabela de Projetos -->
  <div class="projetos-card">
    <p-table [value]="projetosFiltrados" [paginator]="true" [rows]="5" responsiveLayout="scroll">
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="nome">Nome <p-sortIcon field="nome"></p-sortIcon></th>
          <th pSortableColumn="status">Status <p-sortIcon field="status"></p-sortIcon></th>
          <th pSortableColumn="prioridade">Prioridade <p-sortIcon field="prioridade"></p-sortIcon></th>
          <th>Ações</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-projeto>
        <tr>
          <td>{{ projeto.nome }}</td>
          <td>{{ projeto.status }}</td>
          <td>{{ projeto.prioridade }}</td>
          <td>
            <button class="acao-btn visualizar" (click)="visualizarProjeto(projeto)">
              <i class="pi pi-eye"></i>
            </button>
            <button class="acao-btn editar" (click)="abrirDialog(projeto)">
              <i class="pi pi-pencil"></i>
            </button>
            <button class="acao-btn excluir" (click)="confirmarExclusao(projeto)">
              <i class="pi pi-trash"></i>
            </button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- modal para adicionar novo projeto -->

  <p-dialog [(visible)]="exibirDialog" [modal]="true" [dismissableMask]="true"
    [header]="projetoSelecionado.id ? 'Editar Projeto' : 'Novo Projeto'" [style]="{ width: '50vw', maxWidth: '600px' }">

    <div class="modal-content">
      <div class="form-group">
        <label for="nome">Nome do Projeto</label>
        <input id="nome" type="text" pInputText [(ngModel)]="projetoSelecionado.nome"
          placeholder="Digite o nome do projeto">
      </div>

      <div class="form-group">
        <label for="descricao">Descrição</label>
        <textarea id="descricao" rows="3" pInputTextarea [(ngModel)]="projetoSelecionado.descricao"
          placeholder="Descreva o projeto"></textarea>
      </div>

      <div class="form-group">
        <label for="status">Status</label>
        <p-dropdown id="status" [options]="statusOptions" [(ngModel)]="projetoSelecionado.status" optionLabel="label"
          placeholder="Selecione o Status"></p-dropdown>
      </div>

      <div class="form-group">
        <label for="prioridade">Prioridade</label>
        <p-dropdown id="prioridade" [options]="prioridadeOptions" [(ngModel)]="projetoSelecionado.prioridade"
          optionLabel="label" placeholder="Selecione a Prioridade"></p-dropdown>
      </div>

      <div class="form-group">
        <label for="usuarios">Usuários Responsáveis</label>
        <p-multiSelect id="usuarios" [options]="usuariosOptions" [(ngModel)]="projetoSelecionado.idUsuarioResponsavel"
          optionLabel="label" placeholder="Selecione os responsáveis" [maxSelectedLabels]="3">
        </p-multiSelect>
      </div>
      <button pButton label="Cancelar" icon="pi pi-times" (click)="fecharDialog()" class="p-button-text"></button>
    </div>

    <ng-template pTemplate="footer">
      <button pButton label="Cancelar" icon="pi pi-times" (click)="exibirDialog = false" class="p-button-text"></button>
      <button pButton label="Salvar" icon="pi pi-check" (click)="salvarProjeto()" class="p-button-primary"></button>
    </ng-template>
  </p-dialog>


  <!-- fim modal adicionar projeto -->



</div>